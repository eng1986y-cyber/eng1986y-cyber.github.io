<!-- üî• index.html ÏµúÏ¢Ö ÏïàÏ†ïÌåê -->
<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ï†ïÎ≥¥Í≥µÏú† ÌîåÎû´Ìèº</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
body{margin:0;padding:20px;font-family:Arial;background:#f5f5f5;}
.container{max-width:1200px;margin:0 auto;}

.search-box{text-align:center;margin-bottom:30px;}
.search-box input{
  width:320px;height:46px;border:2px solid #87CEEB;
  border-radius:6px;padding:0 12px;font-size:16px;
}
.search-box button{
  height:46px;width:140px;margin-left:6px;
  border:none;border-radius:6px;
  background:#87CEEB;color:#fff;cursor:pointer;
}

.top-banner{
  width:100%;height:120px;margin:20px 0 30px;
  border-radius:14px;overflow:hidden;
  border:2px solid #87CEEB;
}
.top-banner img{width:100%;height:100%;object-fit:cover;}

.grid{
  display:grid;
  grid-template-columns:repeat(6,1fr);
  gap:10px;margin-bottom:40px;
}

.img-ad{
  height:100px;border-radius:12px;
  overflow:hidden;border:1px solid #ddd;
}
.img-ad img{width:100%;height:100%;object-fit:cover;}

.text-ad{
  background:#fff;border:1px solid #ccc;
  padding:12px;text-align:center;
  border-radius:8px;text-decoration:none;color:#222;
}
.text-ad.highlight{
  background:#87CEEB;color:#fff;
}

.square-ad{
  aspect-ratio:1/1;border-radius:12px;
  overflow:hidden;border:1px solid #ddd;
}
.square-ad img{
  width:100%;height:100%;
  object-fit:cover;cursor:pointer;
}

.owner-box{
  margin-top:60px;padding:25px;
  background:#fff;border-radius:14px;
  text-align:center;border:1px solid #ddd;
}
.owner-name{
  font-family:'Bahnschrift Light','Bahnschrift',Arial;
  font-size:20px;font-weight:300;
  letter-spacing:2px;margin-bottom:10px;
}
.owner-sns a{
  margin:0 8px;font-size:22px;
  color:#87CEEB;text-decoration:none;
}

.popup{
  display:none;position:fixed;inset:0;
  background:rgba(0,0,0,0.85);
  justify-content:center;align-items:center;
  z-index:9999;
}
.popup img{
  max-width:90%;max-height:90%;
  border-radius:16px;
}
.close-btn{
  position:absolute;top:30px;right:40px;
  font-size:40px;color:#fff;cursor:pointer;
}

@media (max-width:768px){
  .container{display:flex;flex-direction:column;}
  .top-banner{order:1;height:90px;}
  .search-box{order:2;display:flex;flex-direction:column;gap:8px;}
  #imageAds{order:3;}
  #textAds{order:4;}
  #bottomImageAds{order:5;}
  .owner-box{order:6;}

  .search-box input,.search-box button{
    width:100%;height:48px;margin:0;
  }

  .grid{grid-template-columns:repeat(2,1fr);}
}
</style>
</head>

<body>
<div class="container">

<div class="search-box">
  <input id="searchInput" placeholder="Í≤ÄÏÉâÏñ¥ ÏûÖÎ†•">
  <button onclick="search()">Í≤ÄÏÉâ</button>
</div>

<div class="top-banner" id="topBanner"></div>
<div class="grid" id="imageAds"></div>
<div class="grid" id="textAds"></div>
<div class="grid" id="bottomImageAds"></div>

<div class="owner-box">
  <div class="owner-name" id="ownerName"></div>
  <div class="owner-sns" id="ownerSNS"></div>
</div>

</div>

<div id="imgPopup" class="popup" onclick="closePopup()">
  <span class="close-btn">&times;</span>
  <img id="popupImage">
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="supabase.js"></script>

<script>
function openPopup(src){
  document.getElementById("popupImage").src=src;
  document.getElementById("imgPopup").style.display="flex";
}
function closePopup(){
  document.getElementById("imgPopup").style.display="none";
}

async function loadSite(){
  const { data: ads } = await supabaseClient.from("ads").select("*").order("id");

  imageAds.innerHTML="";
  textAds.innerHTML="";
  bottomImageAds.innerHTML="";

  ads?.forEach(ad=>{
    if(ad.type==="image"){
      imageAds.innerHTML+=`
        <div class="img-ad">
          <a href="${ad.link_url||'#'}" target="_blank">
            <img src="${ad.image_url}">
          </a>
        </div>`;
    }
    if(ad.type==="text"){
      textAds.innerHTML+=`
        <a class="text-ad" href="${ad.link_url||'#'}" target="_blank">
          ${ad.title||"ÌÖçÏä§Ìä∏Í¥ëÍ≥†"}
        </a>`;
    }
    if(ad.type==="square"){
      bottomImageAds.innerHTML+=`
        <div class="square-ad">
          ${ad.link_url ?
            `<a href="${ad.link_url}" target="_blank">
               <img src="${ad.image_url}">
             </a>`
            :
            `<img src="${ad.image_url}"
                 onclick="openPopup('${ad.popup_url||ad.image_url}')">`
          }
        </div>`;
    }
  });

  const { data: settings } =
    await supabaseClient.from("site_settings").select("*").limit(1);

  if(settings?.length){
    const s=settings[0];
    if(s.banner_img){
      topBanner.innerHTML=s.banner_link ?
        `<a href="${s.banner_link}" target="_blank">
           <img src="${s.banner_img}">
         </a>`
        :
        `<img src="${s.banner_img}">`;
    }

    ownerName.innerText=s.owner_name||"";
    ownerSNS.innerHTML="";
    if(s.owner_instagram)
      ownerSNS.innerHTML+=`<a href="${s.owner_instagram}" target="_blank"><i class="fab fa-instagram"></i></a>`;
    if(s.owner_youtube)
      ownerSNS.innerHTML+=`<a href="${s.owner_youtube}" target="_blank"><i class="fab fa-youtube"></i></a>`;
    if(s.owner_blog)
      ownerSNS.innerHTML+=`<a href="${s.owner_blog}" target="_blank"><i class="fas fa-blog"></i></a>`;
  }
}

function search(){
  const keyword=searchInput.value.trim().toLowerCase();
  if(!keyword) return;
  let found=false;
  document.querySelectorAll(".text-ad").forEach(ad=>{
    ad.classList.remove("highlight");
    if(ad.innerText.toLowerCase().includes(keyword)){
      ad.classList.add("highlight");
      found=true;
    }
  });
  if(!found) alert("Í≤ÄÏÉâ Í≤∞Í≥º ÏóÜÏùå");
}

searchInput.addEventListener("keypress",e=>{
  if(e.key==="Enter") search();
});

loadSite();
</script>
</body>
</html>